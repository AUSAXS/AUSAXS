load {
    pdb tests/files/SASDJG5.pdb
    saxs tests/files/SASDJG5.dat
    split chain
}

output tests/output/rigidbody/normal

generate_constraints {
    distance_constraint bond
}

loop 20
    parameter {
        strategy rotations_and_translations
        max_rotation 0.2
        max_translation 1.0
        decay exponential
        decay_rate 0.95
    }
    
    selection sequential_body
    transform rigid
    optimize_once
    
    on_improvement
        print "Improvement found at iteration %i with chi2=%c" green
    end
end

save tests/output/rigidbody/normal_final.pdb
